<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
  @author thomas.quintana@telestax.com (Thomas Quintana)
-->
<mapper namespace="org.mobicents.servlet.sip.restcomm.dao.PresenceRecordsDao">
  <insert id="addPresenceRecord" parameterType="map">
    INSERT INTO "restcomm_presence_records" ("address_of_record", "display_name", "uri", "user_agent", "ttl")
    VALUES (#{address_of_record}, #{display_name}, #{uri}, #{user_agent}, #{ttl});
  </insert>
  
  <select id="getPresenceRecords" parameterType="string" resultType="hashmap">
    SELECT * FROM "restcomm_presence_records" WHERE "address_of_record"=#{address_of_record};
  </select>
  
  <select id="hasPresenceRecord" parameterType="string" resultType="int">
    SELECT COUNT(*) FROM "restcomm_presence_records" WHERE "address_of_record"=#{address_of_record};
  </select>
  
  <delete id="removePresenceRecord" parameterType="string">
    DELETE FROM "restcomm_presence_records" WHERE "uri"=#{uri};
  </delete>
  
  <delete id="removePresenceRecords" parameterType="string">
    DELETE FROM "restcomm_presence_records" WHERE "address_of_record"=#{address_of_record};
  </delete>
  
  <update id="updateClient" parameterType="map">
    UPDATE "restcomm_presence_records" SET "display_name"=#{display_name}, "user_agent"=#{user_agent}, "ttl"=#{ttl}
    WHERE "address_of_record"=#{address_of_record} AND "uri"=#{uri};
  </update>
</mapper>